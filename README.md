Firstly, this implementation builds on the source code provided at http://www.tcpdump.org/pcap.html.

I use a pointer variable to point to the memory address of the incoming packet. The basis of my implementation depends on deciphering the size of each header in the packet. By default, ethernet headers are 14 bytes in size (6+6 for the MAC addresses and 2 bytes for type). Thus I know that my Network layer header begins from the 15th byte of the packet. mydump drops packets that are not IP packets (IPv4 to be precise). Next I extract the header length from the HLEN field. The transport layer header begins at the byte after this header ends. TCP packets are variable length in size but UDP and ICMP headers are fixed (8 bytes). We can similarly detect the starting byte for the packet payload. 
Ive used data structures for each type of header mydump accepts; each has fields to extract the corresponding header information. 
I obtained the MAC addresses and type from ethernet header, length and IP addresses from IP header and source and destination ports from transport layer header. 
Ive used the getopt() function of C to deal with zero or more options that the
user can provide while runnig mydump.
The default device is found (if -i option not provided) by pcap_lookupdev()
Packets are captured either using pcap_open_live() or using
pcap_open_offline() (if -r option is given)
Filters are applied using pcap_compile() and pcap_setfilter()
Finally the capturing takes place by calling pcap_loop()

"Data Communications and Networking" by Forouzan was the main reference point for me through this assignment. 


Sample output:

2017-10-13 20:58:43.185939 00:0d:88:45:4f:56 -> e8:40:f2:ec:52:cf type 0x0800 len 182
192.168.0.86:2049 -> 192.168.0.86:766 TCP
80 00 00 70 37 ce c5 73 00 00 00 01 00 00 00 00  ...p7..s........
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
00 00 00 01 00 00 81 ed 00 00 00 01 00 00 30 96  ..............0.
00 00 30 96 00 00 00 00 00 00 00 7c 00 00 00 00  ..0........|....
00 00 10 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
00 00 fd 00 00 00 00 00 01 16 80 4d 59 cf 2c 15  ...........MY.,.
00 00 00 00 58 6b 7e b7 00 00 00 00 58 85 93 d4  ....Xk~.....X...
00 00 00 00                                       ....

2017-10-13 20:58:43.186342 e8:40:f2:ec:52:cf -> 00:0d:88:45:4f:56 type 0x0800 len 166
192.168.0.66:766 -> 192.168.0.66:2049 TCP
80 00 00 60 38 ce c5 73 00 00 00 00 00 00 00 02  ...`8..s........
00 01 86 a3 00 00 00 03 00 00 00 01 00 00 00 01  ................
00 00 00 20 01 58 8d 96 00 00 00 07 62 75 69 6c  ... .X......buil
64 65 72 00 00 00 30 96 00 00 30 96 00 00 00 01  der...0...0.....
00 00 30 96 00 00 00 00 00 00 00 00 00 00 00 14  ..0.............
01 00 00 01 00 fd 00 00 24 80 16 01 b0 80 16 01  ........$.......
1e 15 ab e0                                       ....

2017-10-13 20:58:43.186591 00:0d:88:45:4f:56 -> e8:40:f2:ec:52:cf type 0x0800 len 182
192.168.0.86:2049 -> 192.168.0.86:766 TCP
80 00 00 70 38 ce c5 73 00 00 00 01 00 00 00 00  ...p8..s........
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
00 00 00 02 00 00 41 ed 00 00 00 02 00 00 30 96  ......A.......0.
00 00 30 96 00 00 00 00 00 00 10 00 00 00 00 00  ..0.............
00 00 10 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
00 00 fd 00 00 00 00 00 01 16 80 b0 59 d7 fe b3  ............Y...
00 00 00 00 58 6d de 8c 00 00 00 00 58 85 93 f4  ....Xm......X...
00 00 00 00                                       ....

2017-10-13 20:58:43.225608 e8:40:f2:ec:52:cf -> 00:0d:88:45:4f:56 type 0x0800 len 66
192.168.0.66:766 -> 192.168.0.66:2049 TCP

